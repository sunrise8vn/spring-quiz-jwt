<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Quiz Form</title>

    <!-- bootstrap css -->
    <link rel="stylesheet" type="text/css" href="/assets/bootstrap/css/bootstrap.css">

    <!-- Font awesome 6 -->
    <link rel="stylesheet" type="text/css" href="/assets/font-awesome-6.1.1/css/all.css">

    <!-- custom styles -->
    <link rel="stylesheet" type="text/css" href="/assets/quiz/css/style.css">
    <link rel="stylesheet" type="text/css" href="/assets/quiz/css/responsive.css">
    <link rel="stylesheet" type="text/css" href="/assets/quiz/css/animation.css">

    <style>
        .btn-question {
            position: absolute;
            top: 155px;
            right: 50px;
            border-radius: 46px;
            /* background-color: #e9e9e9; */
            /* box-shadow: 0px 9px 57px 0px rgba(19, 19, 19, 0.08); */
            width: 270px;
            /* height: 90px; */
            z-index: 10000;
            padding: 10px 15px;
            /*display: flex;*/
            /*gap: 8px;*/
        }
        .btn-question .btn {
            margin-bottom: 5px;
        }
    </style>

</head>
<body class="show-section">

    <section class="steps" id="step">
        <div class="container">
            <div class="mx-auto col-md-10 col-lg-10" style="float: left;">

                <form id="steps" class="show-section" method="post">
                    <!-- step-1 -->
                    <section class="steps-inner pop-slide" id="step-1">
                        <div class="wrapper">
                            <div class="step-heading">
                                <h2>Quiz</h2>
<!--                                <p>Fill out this Trivia quiz for fun!</p>-->
                            </div>
                            <div class="step-bar">
                                    <span class="step-counter">
                                        Question 1 / 4
                                    </span>
                                <div class="step-bar-inner">
                                    <div class="step-bar-move step-move m25"></div>
                                </div>
                            </div>
                            <div>
                                <div class="form-heading">
                                    Make a Multiple Choice Test Template Using Excel
                                </div>
                                <div class="form-inner">
                                    <label class="form-input">
                                        <input type="radio" name="work" value="Activate Developer Tab">
                                        Activate Developer Tab
                                    </label>
                                    <label class="form-input">
                                        <input type="radio" name="work" value="Providing a Lecturer">
                                        Providing a Lecturer
                                    </label>
                                    <label class="form-input">
                                        <input type="radio" name="work" value="Personally Quizzes">
                                        Personally Quizzes
                                    </label>
                                    <label class="form-input">
                                        <input type="radio" name="work" value="Massive Batches" checked>
                                        Massive Batches
                                    </label>
                                </div>

                                <!-- next-prev-btn -->
                                <div class="form-buttons">
                                    <button type="button" class="next">next question<i class="fa-solid fa-arrow-right"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- step-2 -->
                    <section class="steps-inner" id="step-2">
                        <div class="wrapper">
                            <div class="step-heading">
                                <h2>Quiz</h2>
<!--                                <p>Fill out this Trivia quiz for fun!</p>-->
                            </div>
                            <div class="step-bar">
                                    <span class="step-counter">
                                        Question 2 / 4
                                    </span>
                                <div class="step-bar-inner">
                                    <div class="step-bar-move step-move m50"></div>
                                </div>
                            </div>
                            <div>
                                <div class="form-heading">
                                    Select What Suits you Best and Help us Improve Our Services.
                                </div>
                                <div class="form-inner pop-slide">
                                    <label class="form-input">
                                        <input type="radio" name="work1" value="Fronted Developer">
                                        Fronted Developer
                                    </label>
                                    <label class="form-input">
                                        <input type="radio" name="work1" value="Web Designer">
                                        Web Designer
                                    </label>
                                    <label class="form-input">
                                        <input type="radio" name="work1" value="Full Stack Developer">
                                        Full Stack Developer
                                    </label>
                                    <label class="form-input">
                                        <input type="radio" name="work1" value="Backend Developer" checked>
                                        Backend Developer
                                    </label>
                                </div>

                                <!-- next-prev-btn -->
                                <div class="form-buttons">
                                    <button type="button" class="prev"><i class="fa-solid fa-arrow-left"></i>last question
                                    </button>
                                    <button type="button" class="next">next question<i class="fa-solid fa-arrow-right"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- step-3 -->
                    <section class="steps-inner" id="step-3">
                        <div class="wrapper">
                            <div class="step-heading">
                                <h2>Quiz</h2>
<!--                                <p>Fill out this Trivia quiz for fun!</p>-->
                            </div>
                            <div class="step-bar">
                                    <span class="step-counter">
                                        Question 3 / 4
                                    </span>
                                <div class="step-bar-inner">
                                    <div class="step-bar-move step-move m75"></div>
                                </div>
                            </div>
                            <div>
                                <div class="form-heading">
                                    Make a Multiple Choice Test Template Using Excel
                                </div>
                                <div class="form-inner pop-slide">
                                    <label class="form-input">
                                        <input type="radio" name="work3" value="Activate Developer Tab">
                                        Activate Developer Tab
                                    </label>
                                    <label class="form-input">
                                        <input type="radio" name="work3" value="Providing a Lecturer">
                                        Providing a Lecturer
                                    </label>
                                    <label class="form-input">
                                        <input type="radio" name="work3" value="Personally Quizzes">
                                        Personally Quizzes
                                    </label>
                                    <label class="form-input">
                                        <input type="radio" name="work3" value="Massive Batches" checked>
                                        Massive Batches
                                    </label>
                                </div>

                                <!-- next-prev-btn -->
                                <div class="form-buttons">
                                    <button type="button" class="prev"><i class="fa-solid fa-arrow-left"></i>last question
                                    </button>
                                    <button type="button" class="next">next question<i class="fa-solid fa-arrow-right"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- step-4 -->
                    <section class="steps-inner" id="step-4">
                        <div class="wrapper">
                            <div class="step-heading">
                                <h2>Quiz</h2>
<!--                                <p>Fill out this Trivia quiz for fun!</p>-->
                            </div>
                            <div class="step-bar">
                                    <span class="step-counter">
                                        Question 4 / 4
                                    </span>
                                <div class="step-bar-inner">
                                    <div class="step-bar-move step-move m100"></div>
                                </div>
                            </div>
                            <div>
                                <div class="form-heading">
                                    Select What Suits you Best and Help us Improve Our Services.
                                </div>
                                <div class="form-inner pop-slide">
                                    <label class="form-input">
                                        <input type="radio" name="work4" value="Fronted Developer">
                                        Fronted Developer
                                    </label>
                                    <label class="form-input">
                                        <input type="radio" name="work4" value="Web Designer">
                                        Web Designer
                                    </label>
                                    <label class="form-input">
                                        <input type="radio" name="work4" value="ull Stack Developer">
                                        Full Stack Developer
                                    </label>
                                    <label class="form-input">
                                        <input type="radio" name="work4" value="Backend Developer" checked>
                                        Backend Developer
                                    </label>
                                </div>

                                <!-- next-prev-btn -->
                                <div class="form-buttons">
                                    <button type="button" class="prev"><i class="fa-solid fa-arrow-left"></i>last question
                                    </button>
                                    <button id="sub" type="button" class="apply">submit<i
                                            class="phone-ring fa-solid fa-thumbs-up"></i></button>
                                </div>
                            </div>
                        </div>
                    </section>
                </form>
            </div>

            <div class="mx-auto col-md-2 col-lg-2" style="float: left;">
                <!-- timer -->
                <div class="sm-sticky">
                    <div class="timer">
                        <div class="countdown">
                            <span id="countdown-timer" class="time">60</span>
                            <span class="time-ex">sec</span>
                        </div>
                        <div class="timer-heading">
                            Quiz<br/>
                            Time start
                        </div>
                    </div>
                </div>

                <div class="sm-sticky">
                    <div class="btn-question">
<!--                        <button class="btn btn-outline-primary">-->
<!--                            1-->
<!--                        </button>-->
<!--                        <button class="btn btn-outline-primary">-->
<!--                            2-->
<!--                        </button>-->
<!--                        <button class="btn btn-outline-primary">-->
<!--                            1-->
<!--                        </button>-->
<!--                        <button class="btn btn-outline-primary">-->
<!--                            2-->
<!--                        </button>-->
<!--                        <button class="btn btn-outline-primary">-->
<!--                            1-->
<!--                        </button>-->
<!--                        <button class="btn btn-outline-primary">-->
<!--                            2-->
<!--                        </button>-->
<!--                        <button class="btn btn-outline-primary">-->
<!--                            1-->
<!--                        </button>-->
<!--                        <button class="btn btn-outline-primary">-->
<!--                            2-->
<!--                        </button>-->
                    </div>
                </div>
            </div>
        </div>
    </section>


    <div id="error"></div>

    <!-- bootstrap JS -->
    <script src="/assets/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Jquery -->
    <script src="/assets/jquery/jquery-3.6.0.min.js"></script>

    <!-- custom JS -->
    <script src="/assets/quiz/js/custom.js"></script>

    <script src="/assets/js/app.js"></script>

    <script>

        const page = {
            url: {
                getQuiz: AppBase.BASE_URL_STUDENT + '/quiz',
            },
            elements: {},
            loadData: {},
            commands: {}
        }

        const quizExamId = [[${quizExamId}]]
        const offsetIndex = [[${page}]]

        page.elements.steps = $('#steps');
        page.elements.btnQuestion = $('.btn-question');

        page.commands.getQuiz = () => {
            $.ajax({
                type: 'GET',
                url: page.url.getQuiz + '/' + quizExamId + '/' + offsetIndex
            })
                .done((data) => {
                    page.elements.steps.empty();
                    page.elements.btnQuestion.empty();

                    const str = page.commands.renderQuiz(data);
                    page.elements.steps.append(str);

                    for (let i = 1; i <= data.numberQuestion; i++) {
                        const numberQuestionStr = page.commands.renderNumberQuestion(i);
                        page.elements.btnQuestion.append(numberQuestionStr);
                    }
                })
                .fail((jqXHR) => {
                    console.log(jqXHR)
                })
        }

        page.commands.renderAnswers = (item, questionType) => {
            const questionTypeStr = questionType === 'MULTIPLE' ?  'checkbox' : 'radio'
            return `
                <label class="form-input">
                    <input type="${questionTypeStr}" name="work" value="Activate Developer Tab">
                    ${item}
                </label>
            `;
        }

        page.commands.getQuizByQuestion = (num) => {
            $.ajax({
                type: 'GET',
                url: page.url.getQuiz + '/' + quizExamId + '/' + num
            })
                .done((data) => {
                    page.elements.steps.empty();
                    page.elements.btnQuestion.empty();

                    const str = page.commands.renderQuiz(data);
                    page.elements.steps.append(str);

                    for (let i = 1; i <= data.numberQuestion; i++) {
                        const numberQuestionStr = page.commands.renderNumberQuestion(i);
                        page.elements.btnQuestion.append(numberQuestionStr);
                    }
                })
                .fail((jqXHR) => {
                    console.log(jqXHR)
                })
        }

        page.commands.renderQuiz = (obj) => {
            const choices = (obj.questionType === 'SINGLE' || obj.questionType === 'TRUE_FALSE')
                ? 'Chọn một hoặc nhiều:'
                : 'Chọn một:';

            let answers = ''
            $.each(obj.answers, (index, item) => {
                answers += page.commands.renderAnswers(item, obj.questionType);
            })

            return `
                <section class="steps-inner pop-slide" id="step-1">
                    <div class="wrapper">
                        <div class="step-heading">
                            <h2>${obj.quizExamTitle}</h2>
                        </div>
                        <div class="step-bar">
                                <span class="step-counter">
                                    Question ${offsetIndex} / ${obj.numberQuestion}
                                </span>
                            <div class="step-bar-inner">
                                <div class="step-bar-move step-move m25"></div>
                            </div>
                        </div>
                        <div>
                            <div class="form-heading-question-title">
                                ${obj.questionContent}
                            </div>
                            <div class="form-heading">
                                ${choices}
                            </div>
                            <div class="form-inner">
                                ${answers}
                            </div>

                            <!-- next-prev-btn -->
                            <div class="form-buttons">
                                <button type="button" class="next">next question<i class="fa-solid fa-arrow-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
            `;
        }

        page.commands.renderNumberQuestion = (num) => {
             return `
                <button class="btn btn-outline-primary btn-num-question" data-num="${num}">
                    ${num}
                </button>
             `;
        }

        page.initializeControlEvent = () => {
            page.elements.btnQuestion.on('click', '.btn-num-question', function () {
                const num = $(this).data('num');
                page.commands.getQuizByQuestion(num);
            })
        }

        page.loadData = () => {
            page.commands.getQuiz();
        }

        $(() => {
            page.loadData();
            page.initializeControlEvent();
        })


    </script>

</body>

</html>